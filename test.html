<html>
<head>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</head>
<body>
<h2>Stinky Pinky</h2>
Clue1: <div id="clue-1"></div>

Clue2: <div id="clue-2"></div>
<br>
Answer: <input type="text" name="answer" id='answer-input'><br>
<div id="winner">You got it!</div>
<script type="text/javascript">
var clue1;
var ans1;
var ans2;
var syllables;
function request_word(source_word, word_type, success_callback) {
    // see datamuse api for valid word_type, for example rel_spc
    $.ajax({
      type: "GET",
      url: 'https://api.datamuse.com/words?'+ word_type + '=' + source_word + "&md=p",
      dataType: "json",
      cache: false,
      crossDomain: true,
      processData: true,
      success: success_callback
    });
}
function more_info(source_word, word_type, success_callback) {
    // see datamuse api for valid word_type, for example rel_spc
    $.ajax({
      type: "GET",
      url: 'https://api.datamuse.com/words?sp=' + source_word + "&qe=sp&md=sp",
      dataType: "json",
      cache: false,
      crossDomain: true,
      processData: true,
      success: success_callback
    });
}
function set_clue(clue, data) {
  var str = '';
  for (var i =0; i < data.length;i++){
    str += data[i]['word'] + ' ';
  }
  clue.append(str);
}

function get_clues(ans1, ans2) {
 request_word(ans1, 'rel_spc', function(data){set_clue($('#clue-1'), data)});
 request_word(ans2, 'rel_spc', function(data){set_clue($('#clue-2'), data)});
}

words = ['time','year','people','way','day','man','thing','woman','life',
   'child','world','school','state','family','student','group',
   'country','problem','hand','part','place','case','week',
   'company','system','program','question','work','government',
   'number','night','point','home','water','room','mother','area',
   'money','story','fact','month','lot','right','study','book','eye',
   'job','word','business','issue','side','kind','head','house',
   'service','friend','father','power','hour','game','line','end',
   'member','law','car','city','community','name','president','team',
   'minute','idea','kid','body','information','back','parent','face',
   'others','level','office','door','health','person','art','war',
   'history','party','result','change','morning','reason','research',
   'girl','guy','moment','air','teacher','force','education'];

  $(document).ready(function() {
    ans2 = words[Math.floor(Math.random()*words.length)];
	more_info(ans2, 'qe=sp', function(data){
		syllables = data[0]['numSyllables'];
		console.log("Syllables = " + syllables);
	});
    console.log("First word: " + ans2);
    $('#winner').hide();
    $('#answer-input').on('input', function () {
        var guess = $(this).val();
        console.log(guess);
        var words = guess.split(" ");
        if (words[0] === ans1 && words[1] === ans2)
			$('#winner').show();
        else
            $('#winner').hide();

    });
    request_word(ans2, 'rel_rhy', function(data) {
		console.log("Number of rhyming words: " + data.length);
	    for (var index = 0; index<data.length;index++)
		{
			console.log(data[index]);
			console.log(data[index]['tags']);
		    if (data[index]['tags'].indexOf('adj') > -1)
			    console.log("Found adjective");
			if (data[index]['numSyllables'] === syllables && 
			    data[index]['tags'].indexOf('adj') > -1)
			{
				ans1 = data[index]['word'];
				break;
			}
		}
		if (!ans1)
		{
			ans1 = "broken";
		}
		console.log("Rhyming adjective: " + ans1);
		console.log("Noun: " + ans2);
		console.log(ans1 + " " + ans2);
        get_clues(ans1, ans2);
    });
  });
</script>
</body>
</html>
